@page
@model LoginModel
@{
    ViewData["Title"] = "UserSettings";
}

<body>
	<div class="container mt-5">
		<div class="row justify-content-center">
			<div class="col-lg-6 col-md-8 col-sm-10">
				<div class="card">
					<div class="card-header">
						<h3 class="text-center">Профиль</h3>
					</div>
				
					<div class="card-body">
						<div class="mb-3">
							<label for="username" class="form-label">Имя пользователя</label>
							<input type="text" class="form-control" id="username" name="username" value="" readonly>
						</div>
						<div class="mb-3">
							<label for="email" class="form-label">E-mail</label>
							<input type="email" class="form-control" id="email" name="email" value="" readonly>
						</div>
						<div class="mb-3">
							<label for="gender" class="form-label">Пол</label>
							<input type="text" class="form-control" id="gender" name="gender" value="" readonly>
						</div>
						<div class="mb-3">
							<city for="city" class="form-city">Город</city>
							<input type="text" class="form-control" id="city" name="city" value="" readonly>
						</div>
						<div class="mb-3">
							<label for="birthdate" class="form-label">Дата рождения</label>
							<input type="text" class="form-control" id="birthdate" name="birthdate" value="" readonly>
						</div>
						<button type="button" class="btn btn-primary w-100">Изменить профиль</button>
						<button type="button" class="btn btn-success w-100 d-none" id="saveBtn">Сохранить</button>
					</div>
				</div>
			
			</div>
			<div class="col-lg-6 col-md-8 col-sm-10">
				<div class="card">
					<div class="card-header">
						<div class="mb-3 text-center">
							<img src="https://via.placeholder.com/150" class="rounded-circle mb-3" alt="Фотография пользователя" width="150" height="150">
							<div class="input-group">
								<input type="file" class="form-control" id="photo" name="photo" accept="image/*" style="display: none;">
								<button type="button" class="btn btn-secondary" onclick="document.getElementById('photo').click()">Изменить фото</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>

		//заполняем профиль 
		document.getElementById("username").value = "Иван Иванов";
		document.getElementById("email").value = "ivanov@example.com";
		document.getElementById("gender").value = "Мужской";
		document.getElementById("city").value = "Ижевск";
		document.getElementById("birthdate").value = "01.01.1990";

	  // Находим кнопку "Изменить профиль"
	  var editBtn = document.querySelector('button.btn-primary');

	  // Находим все поля ввода
	  var inputFields = document.querySelectorAll('input.form-control');

	  // При клике на кнопку "Изменить профиль" изменяем состояние полей ввода
	  editBtn.addEventListener('click', function() {
		for (var i = 0; i < inputFields.length; i++) {
		  inputFields[i].readOnly = false;
		}
	  });

		var saveBtn = document.querySelector('button#saveBtn');

		editBtn.addEventListener('click', function () {
			for (var i = 0; i < inputFields.length; i++) {
				inputFields[i].readOnly = false;
			}
			editBtn.classList.add('d-none');
			saveBtn.classList.remove('d-none');
		});

		saveBtn.addEventListener('click', function () {
			// отправить измененные данные на сервер или сохранить их локально
			// ...

			for (var i = 0; i < inputFields.length; i++) {
				inputFields[i].readOnly = true;
			}
			saveBtn.classList.add('d-none');
			editBtn.classList.remove('d-none');
		});

		saveBtn.addEventListener('click', function () {
			var hasChanges = false;
			for (var i = 0; i < inputFields.length; i++) {
				if (inputFields[i].value !== inputFields[i].defaultValue) {
					hasChanges = true;
					break;
				}
			}
			if (hasChanges) {
				// отправить измененные данные на сервер или сохранить их локально
				// ...

				for (var i = 0; i < inputFields.length; i++) {
					inputFields[i].readOnly = true;
					inputFields[i].defaultValue = inputFields[i].value;
				}
				saveBtn.classList.add('d-none');
				editBtn.classList.remove('d-none');
			}
		});

		// Находим поле ввода типа "файл"
		var photoInput = document.getElementById('photo');

		// Находим тег "img"
		var profileImg = document.querySelector('img');

		// При изменении значения поля ввода типа "файл"
		photoInput.addEventListener('change', function () {
			// Получаем файл из поля ввода
			var file = photoInput.files[0];

			// Создаем объект FileReader
			var reader = new FileReader();

			// При загрузке файла в объект FileReader
			reader.addEventListener("load", function () {
				// Задаем новое значение атрибута "src" тега "img"
				profileImg.src = reader.result;
			}, false);

			// Читаем файл как URL-адрес
			if (file) {
				reader.readAsDataURL(file);
			}
		});
	</script>
</body>